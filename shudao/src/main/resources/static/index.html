<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Vue-ydui Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 引入样式 -->
    <link rel="stylesheet" href="/assets/ydui/ydui.px.css">
    <link rel="stylesheet" href="/assets/ydui/ydui.base.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1079162_x3qly866um.css">
    <!-- 引入rem自适应类库 -->
    <script src="/assets/ydui/ydui.flexible.js"></script>

    <style type="text/css">
        body{background-color: #f3f3f3}
        .weiKe-search{width: 100%;height: 42px;text-align: center;background-color: #fff;padding: 5px 20px}
        .weiKe-search input{
            height: 32px;width: 100%;border:1px solid indianred;
            border-radius: 20px;padding:0 10px;
        }
        .weiKe-list .num{font-size: 12px}
        .weiKe-list .count{height: 36px;line-height: 36px;padding:0 10px}
        .weiKe-list .countLeft{float: left}
        .weiKe-list .countRight{float: right}
        .weiKe-list li{margin: 0px 0 10px 0;background-color: #fff;}

    </style>
</head>
<body>
<div id="app" style="height: 100%">
    <template>
        <yd-layout>
            <yd-navbar slot="navbar" title="微课"></yd-navbar>
            <div  slot="navbar">
                <div class="weiKe-search">
                   <input type="search" placeholder="请输入要查询的课程名称">
                </div>
            </div>
            <yd-infinitescroll :callback="infinitescroll" ref="infinitescrollDemo">
                <yd-pullrefresh :callback="pullrefresh" ref="pullrefreshDemo">
                <div class="weiKe-list" slot="list">
                    <ul>
                        <li class="card" v-for="item, key in list"  :key="key">
                            <yd-cell-item>
                                <span slot="left">{{item.name}}</span>
                            </yd-cell-item>
                            <img  :src="item.img"  width="100%" >
                            <div class="count">
                                <div class="countLeft">
                                    <span class="num">10分钟前</span>
                                </div>
                                <div class="countRight" style="text-align: right">
                                    <span class="iconfont icon-dianzan-mian"></span>
                                    <span class="num">(12)</span>
                                    <span class="iconfont icon-xiaoxi"></span>
                                    <span class="num">(12)</span>
                                    <span class="iconfont icon-xingxu"></span>
                                    <span class="num">(12)</span>
                                    <span class="iconfont icon-fenxiang1" onclick="call()"></span>
                                    <span class="num">(12)</span>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <!-- 数据全部加载完毕显示 -->
                <span slot="doneTip">啦啦啦，啦啦啦，没有数据啦~~</span>

                <!-- 加载中提示，不指定，将显示默认加载中图标 -->
                <img slot="loadingTip" src="http://static.ydcss.com/uploads/ydui/loading/loading10.svg"/>
                </yd-pullrefresh>
            </yd-infinitescroll>

            <yd-tabbar slot="tabbar" name="tabbar">
                <yd-tabbar-item title="微课" link="#">
                    <img slot="icon" style="height: 25px;" src="http://static.ydcss.com/ydui/img/logo.png" alt="微课">
                </yd-tabbar-item>
                <yd-tabbar-item title="精选" link="#">
                    <img slot="icon" style="height: 25px;" src="http://static.ydcss.com/ydui/img/logo.png" alt="精选">
                </yd-tabbar-item>
                <yd-tabbar-item title="说道" link="#">
                    <img slot="icon" style="height: 25px;" src="http://static.ydcss.com/ydui/img/logo.png" alt="说道">
                </yd-tabbar-item>
                <yd-tabbar-item title="陋室" link="#">
                    <img slot="icon" style="height: 25px;" src="http://static.ydcss.com/ydui/img/logo.png" alt="陋室">
                </yd-tabbar-item>
                <yd-tabbar-item title="成长" link="#">
                    <img slot="icon" style="height: 25px;" src="http://static.ydcss.com/ydui/img/logo.png" alt="成长">
                </yd-tabbar-item>
            </yd-tabbar>

        </yd-layout>
    </template>
</div>
<!-- 引入 Vue -->
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.8/dist/vue.js"></script>
<!-- 引入组件库 -->
<script src="/assets/ydui/ydui.px.js"></script>
<script src="/assets/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="/assets/nativeShare.js"></script>
<script>


    var vue = new Vue({
        el: '#app',

        data:{
            page: 1,
            list: []
        },
        mounted:function(){
            this.getWeiKeList(1);
        },
        methods: {
            submitHandler(value) {
                this.$dialog.toast({mes: `搜索：${value}`});
            },
            infinitescroll() {
               this.getWeiKeList(this.page);
            },
            pullrefresh:function(){

            },
            getWeiKeList(page){
                var _this = this;
                var list = _this.list;
                $.ajax({
                    type : "get",
                    async : false,
                    cache : false,
                    url : "/weike/list",
                    data : {"pageNo": page},
                    dataType : "json",
                    success : function(data) {
                        if(data.status==0){
                            var l =data.list;
                            console.log(l)

                            list = list.concat(l);//c=[1,2,3,4,5,6];
                            console.log(list)
                            _this.list =  list;
                            _this.page =  page+1;
                        }
                    },
                    error : function() {
                        alert('fail');
                    }
                });
            }
        }
    })












    var nativeShare = new NativeShare();
    var shareData = {
        title: '分享标题',
        desc: '分享简介',
        // 如果是微信该link的域名必须要在微信后台配置的安全域名之内的。
        link: "http://www.luozc.cn:20001",
        icon: 'https://avatar.csdn.net/5/2/E/1_qq175023117.jpg?1539049275',
        // 不要过于依赖以下两个回调，很多浏览器是不支持的
        success: function() {
            alert('分享成功')
        },
        fail: function() {
            alert('分享失败')
        }
    }
    nativeShare.setShareData(shareData)
    function call(command) {
        try {
            nativeShare.call(command)
        } catch (err) {
            // 如果不支持，你可以在这里做降级处理
            alert(err.message)
        }
    }
</script>
</body>
</html>