<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!--自动适应移动屏幕-->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <!--优先使用webkit内核渲染-->
    <meta name="renderer" content="webkit">
    <!--不要被百度转码-->
    <meta http-equiv="Cache-Control" content="no-siteapp"/>

    <link rel="stylesheet" href="/assets/AmazeUI/css/amazeui.min.css">
    <link rel="stylesheet" href="/assets/AmazeUI/css/app.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.3.0/video-js.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1079162_x3qly866um.css">
    <style>
        /*搜索框*/
        .search{border-radius: 30px;padding:3px 20px;border:1px solid red;width: 80%;margin: 10px auto}
        .search input{width: 100%;height: 32px;border-radius: 10px;border: 0px;padding:0 10px;outline:none;}

        .title{height: 42px;line-height: 42px;font-size: 18px;padding-left: 10px}

        .share{font-size: 12px;line-height: 32px;padding: 0 10px;height: 32px}
        .share >div{display: inline-block;vertical-align: top;}
        .share .share-left{float: left;font-size: 12px}
        .share .share-right{float: right;font-size: 12px}

        .video{margin: 10px 0}

        .video-js .vjs-big-play-button{
            font-size: 2.5em;
            line-height: 2.3em;
            height: 2.5em;
            width: 2.5em;
            -webkit-border-radius: 2.5em;
            -moz-border-radius: 2.5em;
            border-radius: 2.5em;
            background-color: #73859f;
            background-color: rgba(115,133,159,.5);
            border-width: 0.15em;
            margin-top: -1.25em;
            margin-left: -1.75em;
        }
        /* 中间的播放箭头 */
        .vjs-big-play-button .vjs-icon-placeholder {
            font-size: 1.63em;
        }
        /* 加载圆圈 */
        .vjs-loading-spinner {
            font-size: 2.5em;
            width: 2em;
            height: 2em;
            border-radius: 1em;
            margin-top: -1em;
            margin-left: -1.5em;
        }
    </style>
</head>
<body id="vvvvv">
<!--页头-->
<header data-am-widget="header"
        class="am-header am-header-default">


    <h1 class="am-header-title">
        <a href="#title-link" class="">
            微课
        </a>
    </h1>
</header>


<!--视频列表-->
<div class="weike">
    <div class="search">
        <input type="search"  style="width: 100%" placeholder="请输入查询的商品名称">
    </div>
    <div id="videos" class="videos" >





    </div>


</div>

<!--[if (gte IE 9)|!(IE)]><!-->
<script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
<!--<![endif]-->
<!--[if lte IE 8 ]>
<script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="/assets/AmazeUI/js/amazeui.ie8polyfill.min.js"></script>
<![endif]-->
<script src="/assets/AmazeUI/js/amazeui.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.3.0/video.min.js"></script>
<script type="text/javascript">

    var videos = [
        {   id:"video1"
            ,videoUrl:"http://vjs.zencdn.net/v/oceans.mp4"
            ,title:"视频一标题"
            ,dianzan:12
            ,liulan:12
            ,xiaoxi:18
            ,shouchang:99
            ,fenxiang:66
        },
        {   id:"video2"
            ,videoUrl:"http://vjs.zencdn.net/v/oceans.mp4"
            ,title:"视频二标题"
            ,dianzan:12
            ,liulan:12
            ,xiaoxi:18
            ,shouchang:99
            ,fenxiang:66
        },
        {   id:"video3"
            ,videoUrl:"http://vjs.zencdn.net/v/oceans.mp4"
            ,title:"视频三标题"
            ,dianzan:12
            ,liulan:12
            ,xiaoxi:18
            ,shouchang:99
            ,fenxiang:66
        },
        {   id:"video4"
            ,videoUrl:"http://vjs.zencdn.net/v/oceans.mp4"
            ,title:"视频四标题"
            ,dianzan:12
            ,liulan:12
            ,xiaoxi:18
            ,shouchang:99
            ,fenxiang:66
        }
    ]
    $(function(){
        for (var i=0;i<videos.length;i++){
            var video = videos[i];
            var html = "<div class=\"video\">\n" +
                "            <div class=\"title\">\n" +
                "                <span>"+video.title+"</span>\n" +
                "            </div>\n" +
                "            <div style=\"width: 100%;\">\n" +
                "                <video id=\""+video.id+"\" style=\"width: 100%;height: 240px\" class=\"video-js vjs-fluid vjs-default-skin vjs-big-play-centered \"   preload=\"none\"\n" +
                "                      autoplay='true' poster=\"http://vjs.zencdn.net/v/oceans.png\">\n" +
               // "                    <source src=\""+video.videoUrl+"\" type=\"video/mp4\">\n" +
                "                </video>\n" +
                "            </div>\n" +
                "            <div class=\"share\">\n" +
                "                <div class=\"share-left\">\n" +
                "                    <i class=\"iconfont icon-eye\"></i>\n" +
                "                    <span>"+video.liulan+"</span>\n" +
                "                    &nbsp;\n" +
                "                    <span>刚刚</span>\n" +
                "                </div>\n" +
                "                <div class=\"share-right\">\n" +
                "                    <i class=\"iconfont icon-dianzan-mian\"></i>\n" +
                "                    <span>("+video.dianzan+")</span>\n" +
                "                    <i class=\"iconfont icon-xiaoxi\"></i>\n" +
                "                    <span>("+video.xiaoxi+")</span>\n" +
                "                    <i class=\"iconfont icon-xingxu\"></i>\n" +
                "                    <span>("+video.shouchang+")</span>\n" +
                "                    <i class=\"iconfont icon-fenxiang1\"></i>\n" +
                "                    <span>("+video.fenxiang+")</span>\n" +
                "                </div>\n" +
                "\n" +
                "            </div>\n" +
                "        </div>";
            $("#videos").append(html);
           click(videos[i].id);
        }

        play(videos[0]);
    })


    function click(id){
        $("#"+id).on("click",function(){
            pause();
            play2($(this).attr("id"));
            click($(this).attr("id"))

        })
    }

    function play2(id){
        console.log(id)
        for (var i=0;i<videos.length;i++){
            if(videos[i].id==id){
                play(videos[i])
                break;
            }
        }

    }


    var thisData = "";
    function play(data){
        thisData = data;
        videojs(data.id,{
            controls:true,
            sources: [{
                src: data.videoUrl,
                type: 'video/mp4'
            }]
        },function(){

            this.on('play',function(){

                if(!(thisData.id==this.id_)){
                    pause();
                    for (var i=0;i<videos.length;i++){
                        if(videos[i].id==this.id_){
                            thisData = videos[i];
                            break;
                        }
                    }

                }
                console.log(this.id_)
               // pause();
                console.log("play")
            });

        }).play();

    }

    function pause(){
        videojs(thisData.id).pause()

    }
</script>
<script type="text/javascript">
    var videoList = $('video');
    var wHeigt = window.innerHeight;
    for(var i = 0; i < videoList.length; i++){
        var v = videoList[i];
        v.height = $(v).height();
        v.top = $(v).offset().top;
    }

    var timestart =0;
    var timer = null;
    function log(){
        console.log("---------settimeout" + (new Date()-timestart) );
    }
    $(window).on('scroll',function(){
        pause();
        console.log('-----scrollend:' + (new Date() - timestart) +'ms');
        timestart = new Date();
    });
    var bodyY = 0;
    $(window).on('touchstart',function(){
        bodyY =  $("body")[0].getBoundingClientRect().top;
        console.log('滚动开始');
    });
    $(window).on('touchmove',function(){
        pause();
        console.log('滚动');
    });
    $(window).on('touchend',function(){
        timestart = new Date();

       var thisbodyY =  $("body")[0].getBoundingClientRect().top;

        if(Math.abs(thisbodyY-bodyY)>20){
            console.log('滚动结束');
            for (var i=0;i<videos.length;i++){
                var id = videos[i].id;
                var y =  $("#"+id).parent().parent()[0].getBoundingClientRect().top;
                if(y>0&&y<400){
                    //$('html,body').animate(100, 800);
                    //$("#vvvvv").offset({ top: 100, left: 0})
                    play(videos[i]);
                    break;
                }
            }
        }



             // var x = $("#example_video_1")[0].getBoundingClientRect().left;
             // var y =  $("#example_video_1")[0].getBoundingClientRect().top;
             // console.log(x)
             // console.log(y)
    })
</script>
</body>
</html>